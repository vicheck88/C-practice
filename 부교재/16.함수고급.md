# 함수 고급
## 호출 규약
- 호출 규약: 함수를 호출하는 방식에 대한 일종의 약속으로, 인수의 전달, 리턴값의 반환, 인수 전달에 이용한 메모리 정리 등을 규정
- 호출 규약은 컴파일러 내부에서 일어나는 일

### 스택
- 시스템이 사용하는 메모리 공간으로, cpu가 임시적인 정보를 저장할 때 사용

![스택 vs 힙.png](.\image\스택 vs 힙.png)

- 스택은 메모리의 가장 뒷부분에 위치하며, 값을 넣으면 위로 이동
- 힙과 스택이 만날 경우는 메모리가 부족한 경우
- 스택에 값을 저장하는 동작을 push라 하며, 빼내는 동작을 pop이라 함
- 스택에 저장된 값들은 후입선출(LIFO)의 원칙에 따라 가장 나중에 들어간 값이 가장 먼저 나옴
- C에서는 스택을 직접 조작하지 못하며, 어셈블리어가 필요

### 스택 프레임
- 스택에 저장되는 함수의 호출 정보: 함수로 전달되는 인수, 복귀 번지, 지역변수 등
- 함수를 호출할 때 프로그램은 스택에 함수의 정보를 저장
- 스택에 쌓을 때 기본적인 격자의 크기는 4바이트
- 함수를 처리한 후 할당한 스택을 해제하며, 이때 리턴값을 반환
- 리턴값은 이전에 함수를 호출한 곳으로 이동하여 계산 수행
- 함수에서 다른 함수를 호출할 때, 호출된 함수는 원래 함수의 위에 쌓여 먼저 계산을 수행
- 특징
	1. 인수는 함수 호출 중에만 생명이 유지되는 일종의 지역변수: 함수가 호출될 때 인수들이 초기화되며, 함수 내부에서만 통용됨
	2. 지역변수를 많이 선언하는 것과 함수의 속도에는 관련이 없음
	3. 지역변수를 많이 선언하는 것은 프로그램의 크기와도 무관
	4. 별도의 초기식이 없을 경우 지역변수는 초기화되지 않으며, 이때의 값이 쓰레기값
	5. 함수 호출때마다 스택 프레임이 생겼다 사라짐: 오버헤더가 존재함

## 재귀 호출
### 정의
- 자기가 자신을 호출하는 형식
- 일정 조건이 되었을 때만 자신을 호출하여 중첩된 호출을 벗어나게 됨
![재귀함수.png](.\image\재귀함수.png)

### 재귀호출이 가능한 이유
- 함수가 호출되면 정보가 스택에 쌓임: 스택 프레임
- 각각의 호출 인스턴스의 스택 프레임은 독립적
- 각 호출 인스턴스는 스택에서 고유한 영역을 차지하며, 그 영역에 자신의 지역변수를 기억: 함수가 진행 중인 작업의 상태를 기억하며 자신을 호출하여도 스택에 정보가 유지됨
- 함수 내부의 반환점을 통해 무한 루프에 빠지지 않고 반환됨
- 호출 깊이가 지나치게 길어질 경우, 스택 공간이 소진(stack overflow)될 수 있으므로, 항상 주의해야함
